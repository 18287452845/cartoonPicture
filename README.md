# ğŸ“¸ Photo Toon - ç…§ç‰‡è½¬å¡é€š MVP

åŸºäº Next.js 14 çš„ Web åº”ç”¨ï¼Œæ”¯æŒä¸Šä¼ ç…§ç‰‡æˆ–æ‹ç…§ï¼Œå¹¶é€šè¿‡é˜¿é‡Œäº‘ç™¾ç‚¼ AI ç”Ÿæˆå¡é€šé£æ ¼å›¾ç‰‡ã€‚

## ğŸš€ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 14+ (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: Tailwind CSS
- **å­˜å‚¨**: Cloudflare R2 (S3 å…¼å®¹)
- **AI æœåŠ¡**: é˜¿é‡Œäº‘ç™¾ç‚¼/é€šä¹‰ä¸‡ç›¸
- **å·¥å…·åº“**: 
  - `react-webcam` - æ‘„åƒå¤´æ‹ç…§
  - `qrcode.react` - äºŒç»´ç ç”Ÿæˆ
  - `lucide-react` - å›¾æ ‡

## ğŸ“ é¡¹ç›®ç»“æ„

```
photo-toon-mvp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ upload/route.ts      # å›¾ç‰‡ä¸Šä¼ åˆ° R2
â”‚   â”‚   â”‚   â””â”€â”€ generate/route.ts    # è°ƒç”¨é˜¿é‡Œäº‘ç”Ÿæˆå¡é€šå›¾
â”‚   â”‚   â”œâ”€â”€ layout.tsx               # æ ¹å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ page.tsx                 # ä¸»é¡µé¢
â”‚   â”‚   â””â”€â”€ globals.css              # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ CameraCapture.tsx        # æ‘„åƒå¤´æ‹ç…§ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ImageUploader.tsx        # å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ImagePreview.tsx         # å›¾ç‰‡é¢„è§ˆç»„ä»¶
â”‚   â”‚   â””â”€â”€ ResultDisplay.tsx        # ç»“æœå±•ç¤ºç»„ä»¶
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ r2-client.ts             # R2 å®¢æˆ·ç«¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ ali-client.ts            # é˜¿é‡Œäº‘ API å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ utils.ts                 # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts                 # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ .env.example                     # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md
```

## ğŸ”§ ç¯å¢ƒé…ç½®

### 1. å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶

```bash
cp .env.example .env.local
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `.env.local` å¹¶å¡«å…¥ä½ çš„é…ç½®ï¼š

#### Cloudflare R2 é…ç½®

å‰å¾€ [Cloudflare Dashboard](https://dash.cloudflare.com/) è·å–ï¼š

- `R2_ACCOUNT_ID`: Cloudflare è´¦æˆ· ID
- `R2_ACCESS_KEY_ID`: R2 Access Key ID
- `R2_SECRET_ACCESS_KEY`: R2 Secret Access Key
- `R2_BUCKET_NAME`: å­˜å‚¨æ¡¶åç§°
- `R2_PUBLIC_URL`: å…¬å¼€è®¿é—® URL (å¦‚ `https://your-bucket.r2.dev`)

#### é˜¿é‡Œäº‘ç™¾ç‚¼é…ç½®

å‰å¾€ [é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°](https://dashscope.console.aliyun.com/) è·å–ï¼š

- `ALI_API_KEY`: API Key
- `ALI_API_URL`: API åœ°å€ (é»˜è®¤: `https://dashscope.aliyuncs.com/api/v1/services/aigc/image2image/generation`)
- `ALI_MODEL`: æ¨¡å‹åç§° (é»˜è®¤: `wanx-style-repaint-v1`)

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
npm install
```

## ğŸƒ è¿è¡Œé¡¹ç›®

### å¼€å‘æ¨¡å¼

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000)

### ç”Ÿäº§æ„å»º

```bash
npm run build
npm start
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ‹ç…§/ä¸Šä¼ å›¾ç‰‡
- æ”¯æŒè°ƒç”¨è®¾å¤‡æ‘„åƒå¤´æ‹ç…§
- æ”¯æŒä¸Šä¼ æœ¬åœ°å›¾ç‰‡æ–‡ä»¶
- æ”¯æŒåˆ‡æ¢å‰åæ‘„åƒå¤´

### 2. å›¾ç‰‡é¢„è§ˆ
- å®æ—¶é¢„è§ˆé€‰ä¸­çš„å›¾ç‰‡
- ç¡®è®¤åç”Ÿæˆå¡é€šé£æ ¼

### 3. å¡é€šç”Ÿæˆ
- åŸå›¾ä¸Šä¼ è‡³ Cloudflare R2
- è°ƒç”¨é˜¿é‡Œäº‘ç™¾ç‚¼ AI ç”Ÿæˆå¡é€šå›¾
- ç”Ÿæˆç»“æœæŒä¹…åŒ–å­˜å‚¨è‡³ R2

### 4. ç»“æœå±•ç¤º
- æ˜¾ç¤ºç”Ÿæˆçš„å¡é€šå›¾ç‰‡
- ç”ŸæˆäºŒç»´ç ç”¨äºåˆ†äº«/ä¸‹è½½
- æ”¯æŒç›´æ¥ä¸‹è½½å›¾ç‰‡

## ğŸ”„ å·¥ä½œæµç¨‹

```
ç”¨æˆ·æ“ä½œ
  â†“
æ‹ç…§/ä¸Šä¼ 
  â†“
é¢„è§ˆç¡®è®¤
  â†“
ä¸Šä¼ åˆ° R2 (/api/upload)
  â†“
è·å–åŸå›¾ URL
  â†“
è°ƒç”¨é˜¿é‡Œäº‘ API (/api/generate)
  â†“
ç”Ÿæˆå¡é€šå›¾
  â†“
è½¬å­˜åˆ° R2
  â†“
è¿”å›ç»“æœ URL
  â†“
å±•ç¤º + äºŒç»´ç 
```

## ğŸ› ï¸ API ç«¯ç‚¹

### POST /api/upload

ä¸Šä¼ å›¾ç‰‡åˆ° Cloudflare R2

**è¯·æ±‚ä½“**:
```json
{
  "image": "data:image/jpeg;base64,..."
}
```

**å“åº”**:
```json
{
  "success": true,
  "url": "https://your-bucket.r2.dev/originals/xxx.jpg",
  "key": "originals/xxx.jpg"
}
```

### POST /api/generate

ç”Ÿæˆå¡é€šé£æ ¼å›¾ç‰‡

**è¯·æ±‚ä½“**:
```json
{
  "imageUrl": "https://your-bucket.r2.dev/originals/xxx.jpg"
}
```

**å“åº”**:
```json
{
  "success": true,
  "imageUrl": "https://your-bucket.r2.dev/cartoons/xxx.png"
}
```

## ğŸ“± ç§»åŠ¨ç«¯æ”¯æŒ

- å“åº”å¼è®¾è®¡ï¼Œç§»åŠ¨ç«¯ä¼˜å…ˆ
- æ”¯æŒç§»åŠ¨è®¾å¤‡æ‘„åƒå¤´è°ƒç”¨
- è§¦æ‘¸å‹å¥½çš„äº¤äº’ä½“éªŒ

## ğŸ” å®‰å…¨è€ƒè™‘

- API å¯†é’¥ä»…åœ¨æœåŠ¡ç«¯ä½¿ç”¨ï¼Œä¸æš´éœ²ç»™å‰ç«¯
- å›¾ç‰‡ä¸Šä¼ å¤§å°é™åˆ¶ä¸º 10MB
- æ”¯æŒçš„å›¾ç‰‡æ ¼å¼ï¼šJPGã€PNGã€WEBPã€GIF

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é˜¿é‡Œäº‘ API**: 
   - ç¡®ä¿å·²å¼€é€šé˜¿é‡Œäº‘ç™¾ç‚¼æœåŠ¡
   - æ³¨æ„ API è°ƒç”¨é…é¢å’Œè®¡è´¹
   - å¼‚æ­¥ä»»åŠ¡éœ€è¦è½®è¯¢è·å–ç»“æœï¼ˆå·²å®ç°ï¼‰

2. **Cloudflare R2**:
   - ç¡®ä¿å­˜å‚¨æ¡¶å·²é…ç½®å…¬å¼€è®¿é—®
   - æ³¨æ„å­˜å‚¨å’Œæµé‡è´¹ç”¨

3. **ç”Ÿäº§éƒ¨ç½²**:
   - å»ºè®®ä½¿ç”¨ Vercel/Netlify ç­‰å¹³å°
   - é…ç½®ç¯å¢ƒå˜é‡
   - æ ¹æ®éœ€è¦è°ƒæ•´è¶…æ—¶è®¾ç½®

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯

MIT License
